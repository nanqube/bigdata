# coding:utf-8
import pandas as pd
import random


def ip_to_area(ip: str):
    # 将IP地址转换为整数
    # ip = int(''.join([f"{int(x):08b}" for x in ip.split('.')]), 2)
    ip = int(ip.split(".")[0])
    # 判断IP地址是否在有效范围内
    if 0 <= ip <= 255:
        # 根据IP地址范围判断地区
        if 1 <= ip <= 40:
            return "东北地区", "", ""
        elif 41 <= ip <= 80:
            return "华北地区", "", ""
        elif 81 <= ip <= 120:
            return "华中地区", "", ""
        elif 121 <= ip <= 160:
            return "西北地区", "", ""
        elif 161 <= ip <= 200:
            return "西南地区", "", ""
        elif 202 <= ip <= 254:
            return "华东地区", "", ""
        else:
            return "未知", "", ""
    else:
        return "未知", "", ""


area = {"上海": [
    "黄浦区",
    "卢湾区",
    "徐汇区",
    "长宁区",
    "静安区",
    "普陀去",
    "闸北区",
    "虹口区",
    "杨浦区",
    "闵行区",
    "宝山区",
    "嘉定区",
    "浦东新区",
    "金山区",
    "黄山区",
    "奉贤区",
    "青浦区",
    "崇明区",
    "外滩街道",
    "徐家汇街道",
    "江苏路街道",
    "江宁路街道",
    "真如镇街道",
    "莘庄镇",
    "友谊路街道",
    "新成路街道",
    "花木街道",
    "山阳镇",
    "方松街道",
    "夏阳街道"
],
    "云南": [
        "昆明",
        "曲靖",
        "玉溪",
        "保山",
        "昭通",
        "丽江",
        "普洱",
        "临沧",
        "楚雄彝族自治州",
        "红河哈尼族彝族自治州",
        "文山壮族苗族自治州",
        "西双版纳傣族自治州",
        "大理白族自治州",
        "德宏傣族景颇族自治州",
        "怒江傈僳族自治州",
        "迪庆藏族自治州"
    ],
    "内蒙古": [
        "呼和浩特",
        "包头",
        "乌海",
        "赤峰",
        "通辽",
        "鄂尔多斯",
        "呼伦贝尔",
        "巴彦淖尔",
        "乌兰察布",
        "兴安盟",
        "锡林郭勒盟",
        "阿拉善盟"
    ],
    "北京": [
        "东城区",
        "西城区",
        "朝阳区",
        "丰台区",
        "石景山区",
        "海淀区",
        "门头沟区",
        "房山区",
        "通州区",
        "顺义区",
        "昌平区",
        "大兴区",
        "平谷区",
        "怀柔区",
        "密云区",
        "延庆区",
        "景山街道",
        "金融街街道",
        "东花市街道",
        "东华门街道",
        "安定门街道",
        "北新桥街道",
        "龙潭街道",
        "西长安街街道",
        "月坛街道",
        "德胜街道",
        "朝外街道",
        "建外街道",
        "丰台街道",
        "鲁谷街道",
        "海淀街道",
        "胜利街道",
        "潞源街道",
        "兴丰街道",
        "拱辰街道",
        "大峪街道"
    ],
    "台湾": [
        "台北",
        "高雄",
        "基隆",
        "台中",
        "台南",
        "新竹",
        "嘉义",
        "台北县",
        "宜兰县"
    ],
    "吉林": [
        "长春",
        "四平",
        "辽源",
        "通化",
        "白山",
        "松原",
        "白城",
        "延边朝鲜族自治州",
        "南关区",
        "宽城区",
        "二道区",
        "九台区",
        "龙潭区",
        "丰满区",
        "二道江区",
        "龙山区",
        "昌邑区"
    ],
    "四川": [
        "成都",
        "自贡",
        "攀枝花",
        "泸州",
        "德阳",
        "绵阳",
        "广元",
        "遂宁",
        "内江",
        "乐山",
        "南充",
        "眉山",
        "宜宾",
        "广安",
        "达州",
        "雅安",
        "巴中",
        "资阳",
        "阿坝藏族羌族自治州",
        "甘孜藏族自治州",
        "凉山彝族自治州",
        "自流井区",
        "旌阳区",
        "涪城区",
        "利州区",
        "船山区",
        "东坡区",
        "通川区",
        "雨城区",
        "巴州区",
        "雁江区",
        "武侯区",
        "江阳区",
        "顺庆区"
    ],
    "天津": [
        "和平区",
        "河东区",
        "河西区",
        "南开区",
        "河北区",
        "红桥区",
        "滨海新区",
        "东丽区",
        "西青区",
        "津南区",
        "北辰区",
        "宁河县",
        "武清",
        "静海县",
        "宝坻",
        "蓟县"
    ],
    "宁夏": [
        "银川",
        "石嘴山",
        "吴忠",
        "固原",
        "中卫"
    ],
    "安徽": [
        "合肥",
        "芜湖",
        "蚌埠",
        "淮南",
        "马鞍山",
        "淮北",
        "铜陵",
        "安庆",
        "黄山",
        "滁州",
        "阜阳",
        "宿州",
        "六安",
        "亳州",
        "池州",
        "宣城",
        "瑶海区",
        "庐阳区",
        "蜀山区",
        "包河区",
        "长丰县",
        "肥东县",
        "肥西县",
        "镜湖区",
        "鸠江区",
        "湾沚区",
        "繁昌区",
        "龙子湖区",
        "蚌山区"
    ],
    "山东": [
        "济南",
        "青岛",
        "淄博",
        "枣庄",
        "东营",
        "烟台",
        "潍坊",
        "济宁",
        "泰安",
        "威海",
        "日照",
        "莱芜",
        "临沂",
        "德州",
        "聊城",
        "滨州",
        "菏泽",
        "历下区",
        "市中区",
        "槐荫区",
        "天桥区",
        "历城区",
        "长清区",
        "章丘区",
        "济阳区",
        "莱芜区",
        "钢城区",
        "平阴县",
        "商河县",
        "市南区",
        "市北区",
        "黄岛区",
        "崂山区",
        "李沧区",
        "城阳区",
        "即墨区",
        "胶州市",
        "淄川区",
        "张店区",
        "博山区",
        "临淄区",
        "周村区",
        "桓台县",
        "高青县",
        "薛城区",
        "峄城区",
        "山亭区",
        "东营区",
        "河口区",
        "垦利区"
    ],
    "山西": [
        "太原",
        "大同",
        "阳泉",
        "长治",
        "晋城",
        "朔州",
        "晋中",
        "运城",
        "忻州",
        "临汾",
        "吕梁",
        "小店区",
        "迎泽区",
        "杏花岭区",
        "尖草坪区",
        "万柏林区",
        "新荣区",
        "平城区",
        "云冈区",
        "朔城区",
        "忻府区",
        "繁峙县",
        "宁武县"
    ],
    "广东": [
        "广州",
        "韶关",
        "深圳",
        "珠海",
        "汕头",
        "佛山",
        "江门",
        "湛江",
        "茂名",
        "肇庆",
        "惠州",
        "梅州",
        "汕尾",
        "河源",
        "阳江",
        "清远",
        "东莞",
        "中山",
        "潮州",
        "揭阳",
        "云浮",
        "越秀区",
        "海珠区",
        "荔湾区",
        "天河区",
        "白云区",
        "黄埔区",
        "花都区",
        "番禺区",
        "南沙区",
        "从化区",
        "增城区",
        "福田区",
        "罗湖区",
        "盐田区",
        "南山区",
        "宝安区",
        "龙岗区",
        "龙华区",
        "坪山区",
        "光明区",
        "香洲区",
        "金湾区",
        "斗门区",
        "金平区",
        "澄海区",
        "濠江区",
        "潮阳区",
        "潮南区",
        "禅城区",
        "南海区",
        "顺德区",
        "高明区",
        "三水区",
        "浈江区",
        "武江区",
        "曲江区",
        "源城区",
        "梅江区",
        "梅县区",
        "惠城区",
        "惠阳区",
        "蓬江区",
        "江海区",
        "新会区",
        "江城区",
        "阳东区",
        "赤坎区",
        "霞山区",
        "麻章区",
        "坡头区",
        "茂南区",
        "电白区",
        "端州区"
    ],
    "广西": [
        "南宁",
        "柳州",
        "桂林",
        "梧州",
        "北海",
        "防城港",
        "钦州",
        "贵港",
        "玉林",
        "百色",
        "贺州",
        "河池",
        "来宾",
        "崇左",
        "兴宁区",
        "青秀区",
        "江南区",
        "西乡塘区",
        "鱼峰区",
        "秀峰区"
    ],
    "新疆": [
        "乌鲁木齐",
        "克拉玛依",
        "吐鲁番",
        "哈密",
        "昌吉回族自治州",
        "博尔塔拉蒙古自治州",
        "巴音郭楞蒙古自治州",
        "阿克苏地区",
        "克孜勒苏柯尔克孜自治州",
        "喀什地区",
        "和田地区",
        "伊犁哈萨克自治州",
        "塔城地区",
        "阿勒泰地区"
    ],
    "江苏": [
        "南京",
        "无锡",
        "徐州",
        "常州",
        "苏州",
        "南通",
        "连云港",
        "淮安",
        "盐城",
        "扬州",
        "镇江",
        "泰州",
        "宿迁",
        "玄武区",
        "秦淮区",
        "建邺区",
        "鼓楼区",
        "浦口区",
        "栖霞区",
        "雨花台区",
        "江宁区",
        "六合区",
        "溧水区",
        "高淳区",
        "滨湖区",
        "梁溪区",
        "新吴区",
        "锡山区",
        "惠山区",
        "云龙区",
        "鼓楼区",
        "贾汪区",
        "泉山区",
        "铜山区",
        "天宁区",
        "钟楼区",
        "新北区",
        "武进区",
        "金坛区",
        "姑苏区",
        "虎丘区",
        "吴中区",
        "相城区",
        "吴江区",
        "崇川区",
        "通州区",
        "海门区",
        "海州区",
        "连云区",
        "赣榆区"
    ],
    "江西": [
        "南昌",
        "景德镇",
        "萍乡",
        "九江",
        "新余",
        "鹰潭",
        "赣州",
        "吉安",
        "宜春",
        "抚州",
        "上饶",
        "西湖区",
        "青云谱区",
        "青山湖区",
        "新建区",
        "红谷滩区",
        "珠山区",
        "安源区",
        "湘东区",
        "莲花县",
        "上栗县",
        "芦溪县"
    ],
    "河北": [
        "石家庄",
        "唐山",
        "秦皇岛",
        "邯郸",
        "邢台",
        "保定",
        "张家口",
        "承德",
        "沧州",
        "廊坊",
        "衡水",
        "雄安新区",
        "桥西区",
        "新华区",
        "井陉矿区",
        "裕华区",
        "藁城区",
        "栾城区",
        "鹿泉区",
        "路北区",
        "路南区",
        "古冶区",
        "开平区",
        "丰南区",
        "丰润区",
        "曹妃甸区",
        "海港区",
        "山海关区",
        "北戴河区",
        "抚宁区",
        "邯山区",
        "丛台区",
        "复兴区",
        "峰峰矿区",
        "肥乡区",
        "永年区",
        "襄都区"
    ],
    "河南": [
        "郑州",
        "开封",
        "洛阳",
        "平顶山",
        "安阳",
        "鹤壁",
        "新乡",
        "焦作",
        "濮阳",
        "许昌",
        "漯河",
        "三门峡",
        "南阳",
        "商丘",
        "信阳",
        "周口",
        "驻马店",
        "济源",
        "中原区",
        "二七区",
        "管城回族区",
        "金水区",
        "上街区",
        "惠济区",
        "中牟县",
        "龙亭区",
        "鼓楼区",
        "禹王台区",
        "顺河回族区",
        "祥符区",
        "涧西区",
        "西工区",
        "老城区",
        "瀍河回族区",
        "偃师区",
        "孟津区",
        "湛河区",
        "宝丰县",
        "文峰区",
        "殷都区",
        "安阳县",
        "鹤山区",
        "山城区",
        "淇滨区"
    ],
    "浙江": [
        "杭州",
        "宁波",
        "温州",
        "嘉兴",
        "湖州",
        "绍兴",
        "金华",
        "衢州",
        "舟山",
        "台州",
        "丽水",
        "拱墅区",
        "西湖区",
        "滨江区",
        "萧山区",
        "余杭区",
        "富阳区",
        "临安区",
        "临平区",
        "钱塘区",
        "桐庐县",
        "淳安县",
        "海曙区",
        "江北区",
        "北仑区",
        "镇海区",
        "鄞州区",
        "奉化区",
        "鹿城区",
        "龙湾区",
        "瓯海区",
        "洞头区",
        "永嘉县",
        "平阳县",
        "苍南县",
        "文成县",
        "泰顺县",
        "南湖区",
        "秀洲区",
        "嘉善县",
        "海盐县",
        "吴兴区",
        "南浔区",
        "德清县",
        "长兴县",
        "安吉县"
    ],
    "海南": [
        "海口",
        "三亚",
        "三沙",
        "五指山",
        "琼海",
        "儋州",
        "文昌",
        "万宁",
        "东方"
    ],
    "湖北": [
        "武汉",
        "黄石",
        "十堰",
        "宜昌",
        "襄樊",
        "鄂州",
        "荆门",
        "孝感",
        "荆州",
        "黄冈",
        "咸宁",
        "随州",
        "恩施土家族苗族自治州",
        "仙桃",
        "潜江",
        "天门",
        "神农架林区",
        "江岸区",
        "江汉区",
        "硚口区",
        "东西湖区",
        "汉南区",
        "黄石港区",
        "西塞山区",
        "下陆区",
        "张湾区",
        "茅箭区",
        "郧阳区",
        "夷陵区"
    ],
    "湖南": [
        "长沙",
        "株洲",
        "湘潭",
        "衡阳",
        "邵阳",
        "岳阳",
        "常德",
        "张家界",
        "益阳",
        "郴州",
        "永州",
        "怀化",
        "娄底",
        "湘西土家族苗族自治州",
        "芙蓉区",
        "天心区",
        "岳麓区",
        "开福区",
        "雨花区",
        "望城区",
        "荷塘区",
        "芦淞区",
        "石峰区",
        "雨湖区",
        "岳塘区",
        "珠晖区",
        "雁峰区",
        "蒸湘区"
    ],
    "澳门": [
        "花地玛堂区",
        "圣安多尼堂区",
        "大堂区",
        "望德堂区",
        "风顺堂区"
    ],
    "甘肃": [
        "兰州",
        "嘉峪关",
        "金昌",
        "白银",
        "天水",
        "武威",
        "张掖",
        "平凉",
        "酒泉",
        "庆阳",
        "定西",
        "陇南",
        "临夏回族自治州",
        "甘南藏族自治州"
    ],
    "福建": [
        "福州",
        "厦门",
        "莆田",
        "三明",
        "泉州",
        "漳州",
        "南平",
        "龙岩",
        "宁德",
        "鼓楼区",
        "台江区",
        "仓山区",
        "马尾区",
        "晋安区",
        "闽侯县",
        "连江县",
        "思明区",
        "海沧区",
        "湖里区",
        "芗城区",
        "长泰区",
        "云霄县",
        "东山县",
        "鲤城区",
        "泉港区"
    ],
    "西藏": [
        "拉萨",
        "昌都",
        "山南",
        "日喀则",
        "那曲",
        "阿里地区",
        "林芝"
    ],
    "贵州": [
        "贵阳",
        "六盘水",
        "遵义",
        "安顺",
        "铜仁",
        "黔西南布依族苗族自治州",
        "毕节",
        "黔东南苗族侗族自治州",
        "黔南布依族苗族自治州",
        "观山湖区",
        "南明区",
        "云岩区",
        "花溪区",
        "红花岗区",
        "钟山区",
        "碧江区"
    ],
    "辽宁": [
        "沈阳",
        "大连",
        "鞍山",
        "抚顺",
        "本溪",
        "丹东",
        "锦州",
        "营口",
        "阜新",
        "辽阳",
        "盘锦",
        "铁岭",
        "朝阳",
        "葫芦岛",
        "皇姑区",
        "铁西区",
        "苏家屯区",
        "浑南区",
        "沈北新区",
        "于洪区",
        "沙河口区",
        "甘井子区",
        "旅顺口区",
        "普兰店区",
        "千山区",
        "溪湖区",
        "南芬区",
        "古塔区"
    ],
    "重庆": [
        "万州区",
        "涪陵区",
        "渝中区",
        "大渡口区",
        "江北区",
        "沙坪坝区",
        "九龙坡区",
        "南岸区",
        "北碚区",
        "两江新区",
        "万盛区",
        "双桥区",
        "渝北区",
        "巴南区",
        "长寿区",
        "南川区",
        "永川区",
        "合川区",
        "荣昌区"
    ],
    "陕西": [
        "西安",
        "铜川",
        "宝鸡",
        "咸阳",
        "渭南",
        "延安",
        "汉中",
        "榆林",
        "安康",
        "商洛",
        "碑林区",
        "莲湖区",
        "雁塔区",
        "灞桥区",
        "临潼区",
        "高陵区",
        "蓝田县",
        "周至县",
        "王益区",
        "耀州区",
        "渭滨区",
        "金台区",
        "凤翔区",
        "眉县",
        "千阳县",
        "麟游县"
    ],
    "青海": [
        "西宁",
        "海东地区",
        "海北藏族自治州",
        "黄南藏族自治州",
        "海南藏族自治州",
        "果洛藏族自治州",
        "玉树藏族自治州",
        "海西蒙古族藏族自治州"
    ],
    "香港": [
        "中西区",
        "东区",
        "九龙城区",
        "观塘区",
        "南区",
        "深水埗区",
        "黄大仙区",
        "湾仔区"
    ],
    "黑龙江": [
        "哈尔滨",
        "齐齐哈尔",
        "鸡西",
        "鹤岗",
        "双鸭山",
        "大庆",
        "伊春",
        "佳木斯",
        "七台河",
        "牡丹江",
        "黑河",
        "绥化",
        "大兴安岭地区",
        "道里区",
        "南岗区",
        "道外区",
        "平房区",
        "呼兰区",
        "建华区",
        "龙沙区",
        "富拉尔基区",
        "昂昂溪区",
        "碾子山区"
    ]
}
area2 = {
    "东北地区": [
        "辽宁",
        "吉林",
        "黑龙江"
    ],
    "华东地区": [
        "上海",
        "江苏",
        "浙江",
        "安徽",
        "福建",
        "江西",
        "山东",
        "台湾"
    ],
    "华中地区": [
        "河南",
        "湖北",
        "湖南"
    ],
    "华北地区": [
        "北京",
        "天津",
        "河北",
        "山西",
        "内蒙古"
    ],
    "华南地区": [
        "广东",
        "广西",
        "海南",
        "香港",
        "澳门"
    ],
    "西北地区": [
        "陕西",
        "甘肃",
        "青海",
        "宁夏",
        "新疆"
    ],
    "西南地区": [
        "重庆",
        "四川",
        "贵州",
        "云南",
        "西藏"
    ]
}
# 读取CSV文件
data = pd.read_csv("alldata.csv", encoding="utf-8")
# 应用ip_to_area函数处理IP地址，并将结果分别存储到新的列'area'
data['area'], data['city'], data['province'] = zip(*data['client_ip'].apply(ip_to_area))
province = []
city = []
for i in range(len(data)):
    province.append(random.choices(area2[data['area'][i]])[0])
data['province'] = province
for i in range(len(data)):
    city.append(random.choices(area[data['province'][i]])[0])
data['city'] = city
# 将处理后的数据保存回CSV文件
data.to_csv("data_m2_t1_s2.csv", index=False)
